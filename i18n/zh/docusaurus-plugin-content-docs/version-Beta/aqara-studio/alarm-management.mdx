# 告警管理

本指南将带您全面了解 Aqara Studio 的告警服务，涵盖告警的配置、查看与处理。通过对所有接入设备的不间断实时监控，**告警中心**集中展示各类告警信息，助您及时发现并处理潜在风险，保障智能空间的安全与稳定运行。

## 概述

Aqara Studio 提供全面的告警监控与管理功能，预设了系统默认告警规则，监控协议通信异常和设备掉线；也支持用户自定义告警策略配置，帮助用户实时感知系统风险并快速响应。

- **多维度参数绑定**：可关联设备属性（如温度、湿度）、或业务参数（如设备运行模式），实现动态告警触发。
- **典型配置示例**：
  - 当设备温度持续 5 分钟超过 80℃ 时，触发“高温告警”。
  - 当设备功耗瞬时值低于 10W 时，触发“低功耗异常告警”。
  - 当设备处于“夜间模式”且检测到移动信号时，触发“夜间入侵告警”。

此外，Aqara Studio 提供的告警中心板块可集中展示最新的 10,000 条告警，涵盖告警事件、类别、来源、状态等关键信息，便于用户统一查看和管理。

## 告警类型

告警可分为两大类，系统默认告警和功能点自定义告警：

| 维度 | 系统默认告警 | 功能点自定义告警 |
| -- | -- | -- |
| 含义 | 针对设备基础运行状态的告警。 | 针对设备的特定功能点（如温度、湿度、电量等）的值进行告警 |
| 名称 | Device Alarm Class |  <ul><li>Normal</li><li>Urgent</li><li>Important</li><li>自定义的类别名称</li></ul> |
| 由谁配置 | Aqara Studio | 用户 |
| 可配置性 | 不可修改 | 可创建、修改、删除 |
| 触发条件 | 通信异常、设备掉线 | 设备功能点值满足用户自定义的告警规则 |

:::tip
系统默认告警用于保障平台和设备的基础可用性，规则由系统统一维护，用户无法修改或删除。
:::

### 功能点告警配置

请参考 [配置功能点告警](./device-management/alarms.mdx) 文档，了解如何针对设备的功能点，灵活配置和自定义告警规则，以实现对异常状态的实时监控和及时响应。

## 告警确认流程

告警确认流程包括查看告警和确认，详细步骤如下所示：

1. 在左侧导航栏点击进入**告警中心**，页面将集中展示当前所有告警列表。
2. 告警信息主要包含以下字段：

   | 字段           | 说明                                                        |
   | -------------- | ----------------------------------------------------------- |
   | 告警时间       | 告警发生的具体时间。                                        |
   | 告警 ID        | 告警的唯一表示。                                  |
   | 告警源         | 触发告警的来源。不同类型的告警显示的内容各异，自定义告警可通过双击查看具体设备信息。 |
   | 告警状态       | 当前告警的状态，包括：<ul><li>正常</li><li>异常</li></ul>  |
   | 告警类别       | 告警的分类，详见 [告警类型](#告警类型) 说明。                |
   | 告警数据       | 告警的详细数据内容；针对不同类型告警，字段各有侧重。           |
   | 优先级         | 告警的紧急程度。                                            |
   | 恢复正常时间   | 告警解除、恢复为正常时的时间。                               |
   | 告警确认状态   | 是否已确认该告警，包括：<ul><li>未确认</li><li>已确认</li><li>确认待处理：Aqara 需要花费较长时间进行确认，确认完成后会自动转为已确认。</li></ul> |
   | 告警确认时间   | 告警被确认的时间节点。                                      |
   | 告警处理者     | 执行确认操作的用户信息。                                    |
   | 最后更新时间   | 告警信息最近一次的更新时间。                                 |

3. 双击任一告警，可弹出详情窗口，展示该告警的完整信息。对于功能点自定义告警，可在该窗口中准确定位出是哪个设备的哪个功能点触发了本次告警。
4. 在详情弹窗下方，点击**确认告警**按钮，表示该告警已被知悉。此后，告警的确认状态将变更为`已确认`或`确认待处理`。
5. 按照告警内容提示，您可进一步排查并处理发生的协议异常、设备离线等问题。当根本原因排除后，告警状态会从`异常`自动切换为`正常`。

### 告警数据详解

不同类型的告警记录包含的数据字段略有差异，详见下表：

#### 系统默认告警数据字段

| 字段名      | 说明                       |
| ----------- | -------------------------- |
| sourceName  | 告警来源，通常为设备名称或协议名称。 |
| msgText     | 告警事件描述。         |
| TimeZone    | 设备所处的时区信息。           |

#### 功能点自定义告警数据字段

| 字段名          | 说明                                                         |
| --------------- | ------------------------------------------------------------ |
| offNormalValue  | 仅异常时出现，触发告警的数值（带单位）。                    |
| alarmValue      | 仅异常时出现，触发告警的数值（无单位）。                              |
| presentValue    | 当前功能点的实时数值。                                          |
| fromState       | 功能点发生变化前的状态。                                        |
| toState         | 当前状态（变化后的状态）。                                    |
| sourceName      | 告警源，默认为设备功能点名称。                                     |
| timeDelay       | 触发告警所需的延迟时间（秒）。                                 |
| timeDelayToNormal | 恢复为正常状态的延迟时间（秒）。                             |
| msgText         | 告警事件描述。                                        |
| count           | 当前告警累计发生的次数。                                      |
| deadBand        | （仅数值型）死区阈值范围。                                    |
| highLimit       | （仅数值型）允许的取值上限。                                  |
| lowLimit        | （仅数值型）允许的取值下限。                                  |
| numericValue    | （布尔型、枚举型）属性对应的数值。                            |
| TimeZone        | 设备所处的时区信息。                                          |

:::tip
系统默认告警数据通常较精简，聚焦于来源和内容；而功能点自定义告警则会根据配置规则提供更为丰富、详细的属性和状态信息，便于用户快速定位与分析告警成因。
:::

## 告警中心使用说明

### 配置可见

如需隐藏列表中的部分信息，可点击告警中心的“齿轮”图标，在弹窗中取消勾选不需要显示的字段。

### 筛选数据

如需筛选告警中心的数据，请点击“筛选”图标，在弹窗中可对列表字段设置筛选规则，且勾选所需字段，筛选才会生效：

| 字段 | 配置项说明 |
| -- | -- |
| 告警时间 | <ul><li>开始时间：设置时间范围上限。</li><li>结束时间：设置时间范围下限。</li><li>启用开始时间：是否启用开始时间。</li><li>启用结束时间：是否启用结束时间。</li></ul>  |
| 告警ID | <ul><li>包括：设置多个告警 ID，列表将仅包含相关 ID 的告警。</li><li>排除：设置多个告警 ID，列表将不会展示相关 ID 的告警。</li></ul> |
| 告警状态 | 过滤：选择所需告警状态（可多选），列表将仅展示拥有相关状态的告警。 |
| 告警源 | <ul><li>包括：设置多个告警源，列表将仅包含来自相关告警源的告警。</li><li>排除：设置多个告警源，列表将不会展示来自相关告警源的告警。</li></ul> |
| 优先级 | <ul><li>最小值：设置优先级下限。</li><li>最大值：设置优先级上限。</li><li>启用最小值：是否启用最小值。</li><li>启用最大值：是否启用最大值。</li></ul> |
| 恢复正常时间 | 与告警时间相同。 |
| 告警确认时间 | 与告警时间相同。 |
| 告警处理者 | <ul><li>匹配文本：支持输入完整的用户名称，也支持以下模糊检索语法：<ul><li>%关键词%：检索包含关键词的所有用户名称。</li><li>关键词%：检索开头为关键词的用户名称。</li><li>%关键词：检索结尾为关键词的用户名称。</li></ul></li><li>启用精确匹配：是否要求名称完全一致。</li><li>包含/不包含：列表展示或不展示包含指定文本的用户名称。</li><li>匹配大小写：是否区分大小写。</li></ul> |
| 告警数据 | 过滤项：以数值键的方式筛选包含此数据的告警。可添加多对数值键。 |
| 最后更新时间 | 与告警时间相同。 |

## 常见问题

### 如何快速定位触发功能点自定义告警的设备？

在创建功能点自定义告警规则时，如果直接采用系统默认的功能点名称，收到告警时，告警中心显示的源名称往往只是类似于 `Switch - On/Off` 这样的功能点名，这样无法直观地判断具体是哪个设备出现了问题。

定位具体设备的方法如下：
1. 双击该告警，弹出详情窗口，在窗口中找到“告警源”路径信息。
2. 观察路径中的 `communication` 节点，下一级显示该设备所用协议（如 `Aqara`），再下一级即为设备名称。

例如，告警源路径为：  
`local:|station:|property:/communication/Aqara/Wall Switch H1 (With Neutral, Single Rocker)/points/BinaryOutputObject/PROP_PRESENT_VALUE/alarm`

- `communication` 后的 `Aqara` 表示该设备属于 Aqara 协议。
- `Aqara` 后的 `Wall Switch H1 (With Neutral, Single Rocker)` 即为设备全名，表示具体是哪一个设备触发了该告警。

通过上述方式，即可快速定位到出现异常的具体设备。